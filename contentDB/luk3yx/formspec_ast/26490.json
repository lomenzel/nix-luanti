{
  "author": "luk3yx",
  "content_warnings": [],
  "created_at": "2020-09-29T20:13:09.398260",
  "dev_state": "ACTIVELY_DEVELOPED",
  "donate_url": null,
  "downloads": 14620,
  "forum_url": "https://forum.luanti.org/viewtopic.php?t=23527",
  "forums": 23527,
  "game_support": [],
  "issue_tracker": "https://github.com/luk3yx/minetest-formspec_ast/issues",
  "license": "MIT",
  "long_description": "**This mod provides an API for other mods and is useless by itself.**\n\n## API\n\n - `formspec_ast.parse(formspec_string)`: Parses `formspec_string` and returns\n    an AST.\n - `formspec_ast.unparse(tree)`: Unparses the abstract syntax tree provided\n    and returns a formspec string.\n - `formspec_ast.interpret(string_or_tree)`: Returns a formspec string after\n    (optionally parsing) and unparsing the formspec provided.\n - `formspec_ast.walk(tree)`: Returns an iterator (use this directly in a for\n    loop) that will return all nodes in a tree, including ones inside\n    containers.\n - `formspec_ast.find(tree, node_type)`: Similar to `walk(tree)`, however only\n    returns `node_type` nodes.\n - `formspec_ast.get_element_by_name(tree, name)`: Returns the first element in\n    the tree with the name `name`.\n - `formspec_ast.get_elements_by_name(tree, name)`: Returns a list of all the\n    elements with the name `name`.\n - `formspec_ast.apply_offset(tree, x, y)`: Shifts all elements in `tree`.\n    Similar to `container`.\n - `formspec_ast.flatten(tree)`: Removes all containers and offsets elements\n    that were in containers accordingly. Note that `scroll_container[]`\n    elements are not flattened.\n - `formspec_ast.show_formspec(player_or_name, formname, formspec)`: Similar\n    to `minetest.show_formspec`, however also accepts player objects and will\n    pass `formspec` through `formspec_ast.interpret` first.\n - `formspec_ast.safe_parse(string_or_tree)`: Similar to `formspec_ast.parse`,\n    however will delete any elements that may crash the client (or any I\n    haven't added to the safe element list). The safe element list that this\n    function uses is very limited, it may break complex formspecs.\n - `formspec_ast.safe_interpret(string_or_tree)`: Equivalent to\n    `formspec_ast.unparse(formspec_ast.safe_parse(string_or_tree))`.\n - `formspec_ast.formspec_escape(text)`: The same as `minetest.formspec_escape`,\n    should only be used when formspec_ast is being embedded outside of Minetest.\n\n## AST\n\nThe AST is similar (and generated from) [the formspec element list], however\nall attributes are lowercase.\n\n[the formspec element list]: https://minetest.gitlab.io/minetest/formspec/#elements\n\n### Recent backwards incompatibilities\n\nWhile I try to reduce backwards incompatibilities, sometimes they are necessary\nto either fix bugs in formspec_ast or for implementing new formspec features.\n\n#### April 2023\n\n - The `current_tab` value of tabheader elements is now parsed as a number.\n\n#### February 2022\n\n - The value of scrollbars is now a number instead of a string.\n - The `item`, `listelem`, and `caption` fields are now `items`, `listelems`,\n   and `captions`. The old names still work when unparsing formspecs for now\n   but are no longer used when parsing formspecs.\n\n#### March 2021\n\n - The `index_event` value for `dropdown` is now a boolean instead of a string.\n\n#### February 2021\n\n - The `close_on_enter` value for `field_close_on_enter` is now a boolean\n   instead of a string.\n - The `frame_count`, `frame_duration` and `frame_start` values in\n   `animated_image` are now numbers.\n\n#### September 2020\n\n - The `style[]` element has a `selectors` field instead of `name`. Using\n   `name` when unparsing formspecs still works, however parsed formspecs\n   always use `selectors`.\n\n### Special cases\n\n - `formspec_version` (provided it is the first element) is moved to\n    `tree.formspec_version` (`1` by default).\n\n### `formspec_ast.parse` example\n\n*Note that the whitespace in the formspec is optional and exists for\nreadability. Non-numeric table items in the `dump()` output are re-ordered for\nreadability.*\n\n```lua\n> tree = formspec_ast.parse('size[5,2] '\n>>     .. 'style[name;bgcolor=blue;textcolor=yellow]'\n>>     .. 'container[1,1]'\n>>     .. '    label[0,0;Containers are fun]'\n>>     .. '    container[-1,-1]'\n>>     .. '        button[0.5,0;4,1;name;Label]'\n>>     .. '    container_end[]'\n>>     .. '    label[0,1;Nested containers work too.]'\n>>     .. 'container_end[]'\n>>     .. ' image[0,1;1,1;air.png]')\n> print(dump(tree))\n{\n    formspec_version = 1,\n    {\n        type = \"size\",\n        w = 5,\n        h = 2,\n    },\n    {\n        type = \"style\",\n        selectors = {\"name\"},\n        props = {\n            bgcolor = \"blue\",\n            textcolor = \"yellow\",\n        },\n    },\n    {\n        type = \"container\",\n        x = 1,\n        y = 1,\n        {\n            type = \"label\",\n            x = 0,\n            y = 0,\n            label = \"Containers are fun\",\n        },\n        {\n            type = \"container\",\n            x = -1,\n            y = -1,\n            {\n                type = \"button\",\n                x = 0.5,\n                y = 0,\n                w = 4,\n                h = 1,\n                name = \"name\",\n                label = \"Label\",\n            },\n        },\n        {\n            type = \"label\",\n            x = 0,\n            y = 1,\n            label = \"Nested containers work too.\",\n        },\n    },\n    {\n        type = \"image\",\n        x = 0,\n        y = 1,\n        w = 1,\n        h = 1,\n        texture_name = \"air.png\",\n    },\n}\n\n```\n\n### `formspec_ast.flatten` example\n\n```lua\n> print(dump(formspec_ast.flatten(tree)))\n{\n    formspec_version = 1,\n    {\n        type = \"size\",\n        w = 5,\n        h = 2,\n    },\n    {\n        type = \"style\",\n        selectors = {\"name\"},\n        props = {\n            bgcolor = \"blue\",\n            textcolor = \"yellow\",\n        },\n    },\n    {\n        type = \"label\",\n        x = 1,\n        y = 1,\n        label = \"Containers are fun\",\n    },\n    {\n        type = \"button\",\n        x = 0.5,\n        y = 0,\n        w = 4\n        h = 1,\n        name = \"name\",\n        label = \"Label\",\n    },\n    {\n        type = \"label\",\n        x = 1,\n        y = 2,\n        label = \"Nested containers work too.\",\n    },\n    {\n        type = \"image\",\n        x = 0,\n        y = 1,\n        w = 1,\n        h = 1,\n        texture_name = \"air.png\",\n    },\n}\n```\n\n### `formspec_ast.unparse` example\n\n```lua\n> print(formspec_ast.unparse(tree))\nsize[5,2,]style[name;textcolor=yellow;bgcolor=blue]container[1,1]label[0,0;Containers are fun]container[-1,-1]button[0.5,0;4,1;name;Label]container_end[]label[0,1;Nested containers work too.]container_end[]image[0,1;1,1;air.png]\n\n> print(formspec_ast.unparse(formspec_ast.flatten(tree)))\nsize[5,2,]style[name;textcolor=yellow;bgcolor=blue]label[1,1;Containers are fun]button[0.5,0;4,1;name;Label]label[1,2;Nested containers work too.]image[0,1;1,1;air.png]\n```",
  "maintainers": ["luk3yx"],
  "media_license": "MIT",
  "name": "formspec_ast",
  "provides": ["formspec_ast"],
  "release": 26490,
  "repo": "https://gitlab.com/luk3yx/minetest-formspec_ast",
  "score": 250.3,
  "screenshots": ["https://content.luanti.org/uploads/Ulw5zCcEUG.png"],
  "short_description": "A library to help other mods interpret formspecs.",
  "state": "APPROVED",
  "tags": ["gui", "library"],
  "thumbnail": "https://content.luanti.org/thumbnails/1/Ulw5zCcEUG.png",
  "title": "Formspec AST",
  "translation_url": null,
  "type": "mod",
  "url": "https://content.luanti.org/packages/luk3yx/formspec_ast/releases/26490/download/",
  "video_thumbnail_url": null,
  "video_url": null,
  "website": null,
  "dependencies": { "luk3yx/formspec_ast": [] },
  "hash": "099jb5ym29p16vfc2lwviwz2ink2zinjvc3kbf1zgp803ialn9ln"
}
